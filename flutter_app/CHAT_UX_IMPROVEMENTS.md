# –ê–Ω–∞–ª–∏–∑ —É–ª—É—á—à–µ–Ω–∏–π UX –¥–ª—è —á–∞—Ç–∞ LLM

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- –ë–∞–∑–æ–≤—ã–π —á–∞—Ç —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Markdown –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (sources)
- –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ–≥–æ —á–∞—Ç–∞
- –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É

### ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ü–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ (Streaming)**: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `api_client.dart` –∏ `chat_service.dart`, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ UI (`stream: false` –≤ `chat_screen.dart`)

## –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º LLM —á–∞—Ç–∞–º

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### 1. **–ü–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –æ—Ç–≤–µ—Ç–æ–≤ (Streaming)**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ö–æ–¥ –µ—Å—Ç—å, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –í–∫–ª—é—á–∏—Ç—å streaming –≤ UI (`stream: true`)
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ—Ç–≤–µ—Ç –ø–æ –º–µ—Ä–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (token-by-token)
- –£–ª—É—á—à–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–æ—Ü–µ—Å—Å–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
- `lib/screens/chat_screen.dart` - –∏–∑–º–µ–Ω–∏—Ç—å `stream: false` –Ω–∞ `stream: true`
- `lib/widgets/chat_message.dart` - —É–ª—É—á—à–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ streaming —Å–æ–æ–±—â–µ–Ω–∏–π

#### 2. **–ö–Ω–æ–ø–∫–∞ "–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é" (Stop Generation)**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞
- –û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∫ API
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã**:
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `cancelRequest()` –≤ `ChatService`
- –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –≤ UI –≤–æ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

#### 3. **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ö–Ω–æ–ø–∫–∞ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
- –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å (snackbar)

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
- `lib/widgets/chat_message.dart` - –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `flutter/services` –¥–ª—è Clipboard

#### 4. **–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ï—Å—Ç—å –≤ –º–æ–¥–µ–ª–∏, –Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Ä–µ–º—è –ø–æ–¥ –∫–∞–∂–¥—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "14:30" –∏–ª–∏ "2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥")
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `intl` –ø–∞–∫–µ—Ç –¥–ª—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
- `lib/widgets/chat_message.dart` - –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ timestamp
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `message.timestamp` –∏–∑ –º–æ–¥–µ–ª–∏

### üü° –í–∞–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### 5. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ö–Ω–æ–ø–∫–∞ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–Ω–æ–≤–æ
- –ö–Ω–æ–ø–∫–∞ "–†–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
- –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ—Å–ª–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–≥–æ

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã**:
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã `editMessage()` –∏ `regenerateResponse()` –≤ `ChatService`
- –î–æ–±–∞–≤–∏—Ç—å UI –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### 6. **–£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –¢–æ–ª—å–∫–æ –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ–≥–æ —á–∞—Ç–∞  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
- `lib/services/chat_service.dart` - –¥–æ–±–∞–≤–∏—Ç—å `deleteMessage(String id)`
- `lib/widgets/chat_message.dart` - –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è

#### 7. **–ê–≤–∞—Ç–∞—Ä—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–∫–æ–Ω–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- –ê–≤–∞—Ç–∞—Ä –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ (–∏–∫–æ–Ω–∫–∞ –±–æ—Ç–∞/AI)
- –†–∞–∑–º–µ—â–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–≤ —Ä—è–¥–æ–º —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
- `lib/widgets/chat_message.dart` - –¥–æ–±–∞–≤–∏—Ç—å –∞–≤–∞—Ç–∞—Ä—ã

#### 8. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–∞**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ë–∞–∑–æ–≤—ã–π Markdown  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –¥–ª—è –±–ª–æ–∫–æ–≤ –∫–æ–¥–∞
- –ö–Ω–æ–ø–∫–∞ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥" –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ –∫–æ–¥–∞
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- –£–ª—É—á—à–µ–Ω–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

**–ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
- `flutter_highlight` –∏–ª–∏ `highlight` –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `flutter_markdown` —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –æ–ø—Ü–∏—è–º–∏

#### 9. **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏ (Typing Indicator)**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ü—Ä–æ—Å—Ç–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ø–µ—á–∞—Ç–∞–µ—Ç..." –≤–æ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –∏–¥–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
- `lib/widgets/chat_message.dart` - —É–ª—É—á—à–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
- –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –≤–∏–¥–∂–µ—Ç `TypingIndicator`

#### 10. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ü—Ä–æ—Å—Ç—ã–µ —á–∏–ø—ã  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- –ü—Ä–µ–≤—å—é –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –ø–æ —Ç–∏–ø–∞–º (RAG, Law, etc.)
- –ò–∫–æ–Ω–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
- `lib/widgets/chat_message.dart` - —É–ª—É—á—à–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ sources

### üü¢ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

#### 11. **–†–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (–ª–∞–π–∫–∏/–¥–∏–∑–ª–∞–π–∫–∏)**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ö–Ω–æ–ø–∫–∏ üëç/üëé –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∞–∫—Ü–∏–π
- –û—Ç–ø—Ä–∞–≤–∫–∞ feedback –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### 12. **–ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤ (–Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Ç–æ–≤)**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –û–¥–∏–Ω —á–∞—Ç  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —á–∞—Ç–æ–≤
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —á–∞—Ç–æ–≤
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —á–∞—Ç–∞–º–∏
- –£–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–æ–≤

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã**:
- `lib/models/chat.dart` - –º–æ–¥–µ–ª—å —á–∞—Ç–∞
- `lib/screens/chats_list_screen.dart` - —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
- –û–±–Ω–æ–≤–∏—Ç—å `ChatService` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —á–∞—Ç–∞–º–∏

#### 13. **–ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ü–æ–∏—Å–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏–π
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ, —Ç–∏–ø—É —Å–æ–æ–±—â–µ–Ω–∏—è
- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

#### 14. **–≠–∫—Å–ø–æ—Ä—Ç —á–∞—Ç–∞**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
- –≠–∫—Å–ø–æ—Ä—Ç –≤ Markdown
- –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
- `share_plus` –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞

#### 15. **–°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ/—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–∏–¥–Ω—ã  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –±–æ–ª—å—à–µ/–º–µ–Ω—å—à–µ"
- –ü–æ–∫–∞–∑ –ø–µ—Ä–≤—ã—Ö N —Å—Ç—Ä–æ–∫ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å

#### 16. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –ø–æ–≤—Ç–æ—Ä–æ–º**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ü–æ–∫–∞–∑ –æ—à–∏–±–∫–∏  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ö–Ω–æ–ø–∫–∞ "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å" –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å –æ—à–∏–±–∫–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ

#### 17. **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ü—Ä–æ—Å—Ç–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω —Å —Å–µ—Ä–≤–µ—Ä–∞)
- –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- –°—á–µ—Ç—á–∏–∫ —Ç–æ–∫–µ–Ω–æ–≤/—Å–∏–º–≤–æ–ª–æ–≤

#### 18. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ü—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
- `image_picker` –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –£–ª—É—á—à–∏—Ç—å `cached_network_image` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

#### 19. **–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ö–Ω–æ–ø–∫–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- –ó–∞–ø–∏—Å—å –≥–æ–ª–æ—Å–∞
- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—á–∏ –≤ —Ç–µ–∫—Å—Ç (STT)
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞ –≤ —á–∞—Ç

**–ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
- `speech_to_text` –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏

#### 20. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ë–∞–∑–æ–≤—ã–π TextField  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø—Ä–∏ –≤–≤–æ–¥–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏—è)
- –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ (Cmd+Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏, Cmd+K –¥–ª—è –ø–æ–∏—Å–∫–∞)
- –£–ª—É—á—à–µ–Ω–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∂–∏—Ä–Ω—ã–π, –∫—É—Ä—Å–∏–≤ —á–µ—Ä–µ–∑ Markdown)

#### 21. **–¢–µ–º—ã –∏ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ë–∞–∑–æ–≤–∞—è —Ç–µ–º–∞  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ç–µ–º
- –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è —Ü–≤–µ—Ç–æ–≤
- –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞
- –ü–ª–æ—Ç–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

#### 22. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç  
**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –æ—Ç–≤–µ—Ç–∞—Ö (–µ—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–µ)
- –ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –§–∞–∑–∞ 1 (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ - 1-2 –Ω–µ–¥–µ–ª–∏)
1. ‚úÖ –ü–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –æ—Ç–≤–µ—Ç–æ–≤
2. ‚úÖ –ö–Ω–æ–ø–∫–∞ "–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é"
3. ‚úÖ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
4. ‚úÖ –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è

### –§–∞–∑–∞ 2 (–í–∞–∂–Ω–æ - 2-3 –Ω–µ–¥–µ–ª–∏)
5. ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è
6. ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
7. ‚úÖ –ê–≤–∞—Ç–∞—Ä—ã
8. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–∞
9. ‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏
10. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

### –§–∞–∑–∞ 3 (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ - 3-4 –Ω–µ–¥–µ–ª–∏)
11. ‚úÖ –†–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
12. ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤
13. ‚úÖ –ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏
14. ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç —á–∞—Ç–∞
15. ‚úÖ –°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

### –§–∞–∑–∞ 4 (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
16. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
17. ‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
18. ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
19. ‚úÖ –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥
20. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞
21. ‚úÖ –¢–µ–º—ã –∏ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è
22. ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è pubspec.yaml

```yaml
# –î–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
flutter/services: # –í—Å—Ç—Ä–æ–µ–Ω–æ –≤ Flutter

# –î–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –∫–æ–¥–∞
flutter_highlight: ^0.7.0
highlight: ^0.7.0

# –î–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
share_plus: ^7.2.1

# –î–ª—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞
speech_to_text: ^6.6.0

# –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
image_picker: ^1.0.7

# –î–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
flutter_local_notifications: ^16.3.0
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

```
lib/
‚îú‚îÄ‚îÄ widgets/
‚îÇ   ‚îú‚îÄ‚îÄ typing_indicator.dart      # –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ code_block.dart            # –ë–ª–æ–∫ –∫–æ–¥–∞ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ message_actions.dart        # –î–µ–π—Å—Ç–≤–∏—è —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º (–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å, —É–¥–∞–ª–∏—Ç—å, etc.)
‚îÇ   ‚îî‚îÄ‚îÄ source_chip.dart           # –£–ª—É—á—à–µ–Ω–Ω—ã–π —á–∏–ø –∏—Å—Ç–æ—á–Ω–∏–∫–∞
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ chat.dart                  # –ú–æ–¥–µ–ª—å —á–∞—Ç–∞ (–¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏)
‚îî‚îÄ‚îÄ screens/
    ‚îî‚îÄ‚îÄ chats_list_screen.dart     # –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
```

## –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –ü–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞

```dart
// –í chat_screen.dart
await chatService.sendMessage(
  text,
  useRag: settings.useRag,
  useLaw: settings.useLaw,
  stream: true, // –í–∫–ª—é—á–∏—Ç—å streaming
);
```

### 2. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è

```dart
// –í chat_message.dart
IconButton(
  icon: Icon(Icons.copy, size: 16),
  onPressed: () {
    Clipboard.setData(ClipboardData(text: message.content));
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞')),
    );
  },
)
```

### 3. –í—Ä–µ–º—è —Å–æ–æ–±—â–µ–Ω–∏—è

```dart
// –í chat_message.dart
Text(
  DateFormat('HH:mm').format(message.timestamp),
  style: TextStyle(
    fontSize: 10,
    color: Colors.grey,
  ),
)
```

## –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏–π –æ–∂–∏–¥–∞—é—Ç—Å—è:
- ‚¨ÜÔ∏è –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚¨ÜÔ∏è –£–ª—É—á—à–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞
- ‚¨ÜÔ∏è –°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—à–∏–±–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚¨ÜÔ∏è –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –°—Å—ã–ª–∫–∏ –Ω–∞ –ø—Ä–∏–º–µ—Ä—ã

–î–ª—è –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞:
- ChatGPT (OpenAI) - —ç—Ç–∞–ª–æ–Ω–Ω—ã–π UX
- Claude (Anthropic) - –æ—Ç–ª–∏—á–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- Gemini (Google) - —Ö–æ—Ä–æ—à–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
- Perplexity - –æ—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏

